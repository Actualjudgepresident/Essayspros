<!-- write.html (Instructions and upload page with pricing rules and checkout link) -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Write My Order | EssaysPros.com</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  <link rel="stylesheet" href="style.css" />
  <style>
    .cardBox { background:#fff; border:1px solid #dbeafe; border-radius:18px; padding:16px; box-shadow:0 10px 30px rgba(37,99,235,.06); }
    .grid2 { display:grid; grid-template-columns: 1fr 1fr; gap:14px; }
    .grid3 { display:grid; grid-template-columns: 1fr 1fr 1fr; gap:14px; }
    .field label { display:block; margin-bottom:6px; font-size:13px; font-weight:800; color:#1e3a8a; }
    .field input, .field select, .field textarea {
      width:100%; border:1px solid #dbeafe; border-radius:12px; padding:12px; background:#fff; color:#0f172a; outline:none; font-size:15px;
    }
    .field textarea { min-height:140px; resize:vertical; }
    .muted2 { color:#475569; font-size:14px; line-height:1.55; }
    .pill { display:inline-flex; padding:6px 10px; border-radius:999px; border:1px solid #dbeafe; background:#f3f8ff; color:#1e3a8a; font-weight:900; font-size:12px; }
    .hr { height:1px; background:#dbeafe; margin:14px 0; }
    .actions { display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; align-items:center; }
    .priceBox { background:#f3f8ff; border:1px solid #dbeafe; border-radius:16px; padding:14px; }
    .priceBig { font-weight:900; font-size:22px; color:#0f172a; margin-top:6px; }
    .warn { background:#fff7ed; border:1px solid #fed7aa; color:#9a3412; border-radius:14px; padding:12px; margin-top:10px; font-weight:800; font-size:13px; line-height:1.5; }
    @media (max-width: 980px) { .grid2, .grid3 { grid-template-columns: 1fr; } }

    /* Support floating icon */
    .supportFab {
      position: fixed;
      right: 18px;
      bottom: 18px;
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: #4f6ef7;
      border: 2px solid rgba(255,255,255,.9);
      box-shadow: 0 14px 34px rgba(15,23,42,.25);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 1000;
    }
    .supportFab svg { width: 30px; height: 30px; fill: #fff; }
    .supportMenu {
      position: fixed;
      right: 18px;
      bottom: 92px;
      width: 260px;
      background: #ffffff;
      border: 1px solid #dbeafe;
      border-radius: 16px;
      box-shadow: 0 14px 34px rgba(15,23,42,.18);
      padding: 12px;
      display: none;
      z-index: 1000;
    }
    .supportMenu h4 { margin: 0 0 8px; color: #0f172a; font-weight: 900; font-size: 14px; }
    .supportMenu a {
      display: block;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #dbeafe;
      background: #f3f8ff;
      color: #1e3a8a;
      font-weight: 900;
      text-decoration: none;
      margin-top: 8px;
    }
  </style>
</head>

<body>
  <header class="siteHeader">
    <div class="container headerRow">
      <a class="brand" href="index.html">EssaysPros</a>
      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="orders.html">Orders</a>
        <a href="privacy.html">Privacy</a>
        <a href="terms.html">Terms</a>
        <a href="refund.html">Refund</a>
        <a href="contact.html">Contact</a>
      </nav>
      <div class="headerActions">
        <a class="btnOutline" href="login.html">Log in</a>
        <a class="btnPrimary active" href="write.html">Write my order</a>
      </div>
    </div>
  </header>

  <main class="pageMain">
    <section class="container section">
      <h1>Order instructions</h1>
      <p class="muted2">Complete the form, upload your files, and proceed to checkout.</p>

      <div class="cardBox">
        <div class="grid2">
          <div>
            <div class="pill">Step 1</div>
            <h2 style="margin:10px 0 6px;">Customer and task</h2>
            <p class="muted2" style="margin:0;">Your email is used to track orders.</p>

            <div class="field" style="margin-top:10px;">
              <label for="email">Email</label>
              <input id="email" type="email" placeholder="you@example.com" />
            </div>

            <div class="grid2">
              <div class="field">
                <label for="taskType">Task type</label>
                <select id="taskType">
                  <option value="paper">Paper</option>
                  <option value="slides">Slides</option>
                  <option value="programming">Coding</option>
                  <option value="excel">Excel</option>
                </select>
              </div>

              <div class="field">
                <label for="level">Academic level</label>
                <select id="level">
                  <option>High school</option>
                  <option>Undergraduate</option>
                  <option selected>Graduate</option>
                  <option>Doctoral</option>
                </select>
              </div>
            </div>

            <div class="field">
              <label>
                <input id="repeatCustomer" type="checkbox" />
                Repeat customer discount
              </label>
              <div class="muted2">Paper becomes $10 per page, slides become $4 per slide.</div>
            </div>
          </div>

          <div>
            <div class="pill">Step 2</div>
            <h2 style="margin:10px 0 6px;">Scope and deadline</h2>

            <div class="grid3">
              <div class="field">
                <label for="pages">Pages</label>
                <input id="pages" type="number" min="0" value="0" />
              </div>
              <div class="field">
                <label for="slides">Slides</label>
                <input id="slides" type="number" min="0" value="0" />
              </div>
              <div class="field">
                <label for="hours">Coding hours</label>
                <input id="hours" type="number" min="0" value="0" />
              </div>
            </div>

            <div class="field" style="margin-top:10px;">
              <label for="deadline">Deadline</label>
              <input id="deadline" type="datetime-local" />
            </div>

            <div class="warn" id="codingNote" style="display:none;">
              Coding tasks start at $50. Additional payment may be required if the assignment requires more work than the initial scope.
            </div>
          </div>
        </div>

        <div class="hr"></div>

        <div class="grid2">
          <div class="field">
            <label for="topic">Topic or title</label>
            <input id="topic" type="text" placeholder="Example: Operating Systems process scheduling" />
          </div>

          <div class="field">
            <label for="file">Upload files</label>
            <input id="file" type="file" multiple />
            <div class="muted2">Files are stored locally for demonstration only.</div>
          </div>
        </div>

        <div class="field" style="margin-top:10px;">
          <label for="instructions">Instructions</label>
          <textarea id="instructions" placeholder="Write detailed instructions, grading rubric, references, and formatting requirements."></textarea>
        </div>

        <div class="hr"></div>

        <div class="grid2">
          <div class="priceBox">
            <div class="pill">Pricing</div>
            <div class="muted2" style="margin-top:8px;">
              Paper: $12 per page, slides: $6 per slide, Excel: $18 per task, coding: $50 minimum.
              Repeat customer discount applies to paper and slides.
            </div>
            <div class="priceBig">Total: <span id="total">$0.00</span> <span class="muted2">USD</span></div>
            <div class="muted2" id="rateLine" style="margin-top:8px;"></div>
          </div>

          <div>
            <div class="pill">Step 3</div>
            <h2 style="margin:10px 0 6px;">Checkout</h2>
            <p class="muted2" style="margin:0;">
              Select checkout to complete payment using your Stripe payment link.
            </p>

            <div class="actions">
              <button class="btnPrimary" type="button" id="checkoutBtn">Proceed to checkout</button>
              <a class="btnOutline" href="orders.html">View orders</a>
            </div>

            <div class="muted2" style="margin-top:10px;">
              After payment, your order is saved and visible in the Orders page.
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Support icon and menu -->
  <button class="supportFab" type="button" id="supportFab" aria-label="Support">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M20 2H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3v3a1 1 0 0 0 1.64.77L13.5 20H20a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Zm0 16h-6.9a1 1 0 0 0-.64.23L9 20.9V19a1 1 0 0 0-1-1H4V4h16v14Z"/>
    </svg>
  </button>

  <div class="supportMenu" id="supportMenu">
    <h4>Contact support</h4>
    <!-- Replace the phone with your real Kenya number in international format -->
    <a id="waLink" href="https://wa.me/254700000000?text=Hello%20EssaysPros%2C%20I%20need%20help%20with%20my%20order." target="_blank" rel="noopener">Chat on WhatsApp</a>
    <a id="callLink" href="tel:+254700000000">Call now</a>
    <a href="mailto:support@essayspros.com">Email support</a>
  </div>

  <footer class="siteFooter">
    <div class="container footerRow">
      <div>
        <div class="brandSmall">EssaysPros</div>
        <div class="muted">© <span id="year"></span> EssaysPros.com. All rights reserved.</div>
      </div>
      <div class="footerLinks">
        <a href="privacy.html">Privacy</a>
        <a href="terms.html">Terms</a>
        <a href="refund.html">Refund</a>
        <a href="contact.html">Contact</a>
      </div>
    </div>
  </footer>

  <script>
    (function () {
      document.getElementById("year").textContent = String(new Date().getFullYear());

      const activeEmail = (localStorage.getItem("essayspros_active_email") || "").trim();
      const emailEl = document.getElementById("email");
      if (activeEmail) emailEl.value = activeEmail;

      const taskTypeEl = document.getElementById("taskType");
      const repeatEl = document.getElementById("repeatCustomer");
      const pagesEl = document.getElementById("pages");
      const slidesEl = document.getElementById("slides");
      const hoursEl = document.getElementById("hours");
      const totalEl = document.getElementById("total");
      const rateLineEl = document.getElementById("rateLine");
      const codingNote = document.getElementById("codingNote");

      const STRIPE_LINK = "https://buy.stripe.com/test_4gMcN4fCY5EmaMi2hlg3600";

      function money(n) { return "$" + Number(n || 0).toFixed(2); }

      function computeTotal() {
        const type = taskTypeEl.value;
        const isRepeat = !!repeatEl.checked;

        const pages = Math.max(0, Number(pagesEl.value || 0));
        const slides = Math.max(0, Number(slidesEl.value || 0));
        const hours = Math.max(0, Number(hoursEl.value || 0));

        let total = 0;
        let line = "";

        if (type === "paper") {
          const rate = isRepeat ? 10 : 12;
          total = pages * rate;
          line = "Paper rate: " + money(rate) + " per page × " + pages;
        } else if (type === "slides") {
          const rate = isRepeat ? 4 : 6;
          total = slides * rate;
          line = "Slides rate: " + money(rate) + " per slide × " + slides;
        } else if (type === "excel") {
          total = 18;
          line = "Excel rate: " + money(18) + " per task";
        } else if (type === "programming") {
          total = 50;
          line = "Coding minimum: " + money(50) + " (additional payment may apply)";
        }

        codingNote.style.display = (type === "programming") ? "block" : "none";
        totalEl.textContent = money(total);
        rateLineEl.textContent = line;

        return { total, currency: "USD" };
      }

      function enforceInputs() {
        const type = taskTypeEl.value;

        pagesEl.disabled = (type !== "paper");
        slidesEl.disabled = (type !== "slides");
        hoursEl.disabled = (type !== "programming");

        if (type !== "paper") pagesEl.value = "0";
        if (type !== "slides") slidesEl.value = "0";
        if (type !== "programming") hoursEl.value = "0";

        computeTotal();
      }

      [taskTypeEl, repeatEl, pagesEl, slidesEl, hoursEl].forEach(el => {
        el.addEventListener("input", function () {
          enforceInputs();
        });
        el.addEventListener("change", function () {
          enforceInputs();
        });
      });

      enforceInputs();

      document.getElementById("checkoutBtn").addEventListener("click", function () {
        const email = emailEl.value.trim();
        if (!email) { alert("Please enter your email."); return; }

        localStorage.setItem("essayspros_active_email", email);

        const { total, currency } = computeTotal();

        const fileEl = document.getElementById("file");
        const files = [];
        if (fileEl.files && fileEl.files.length) {
          for (let i = 0; i < fileEl.files.length; i++) files.push(fileEl.files[i].name);
        }

        const order = {
          id: "EP-" + Math.random().toString(16).slice(2, 8).toUpperCase(),
          createdAt: new Date().toISOString(),
          status: "Ongoing",
          approved: false,
          revisionRequested: false,
          customerEmail: email,
          taskType: taskTypeEl.value,
          level: document.getElementById("level").value,
          pages: Number(pagesEl.value || 0),
          slides: Number(slidesEl.value || 0),
          hours: Number(hoursEl.value || 0),
          deadline: document.getElementById("deadline").value || "",
          topic: document.getElementById("topic").value || "",
          instructions: document.getElementById("instructions").value || "",
          uploadedFileNames: files,
          paymentMethod: "Stripe link",
          total: total,
          currency: currency
        };

        let list = [];
        try { list = JSON.parse(localStorage.getItem("essayspros_orders") || "[]"); } catch (e) { list = []; }
        list.unshift(order);
        localStorage.setItem("essayspros_orders", JSON.stringify(list));

        window.open(STRIPE_LINK, "_blank", "noopener");
        window.location.href = "orders.html";
      });

      const fab = document.getElementById("supportFab");
      const menu = document.getElementById("supportMenu");

      fab.addEventListener("click", function () {
        menu.style.display = (menu.style.display === "block") ? "none" : "block";
      });

      document.addEventListener("click", function (e) {
        if (!menu.contains(e.target) && e.target !== fab && !fab.contains(e.target)) {
          menu.style.display = "none";
        }
      });
    })();
  </script>
</body>
</html>
